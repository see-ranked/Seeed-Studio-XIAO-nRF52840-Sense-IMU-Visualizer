# XIAO MG24 Sense バッテリーパッド接続ガイド

XIAO MG24 Senseの背面にあるBAT(+)とBAT(-)パッドにCR2032ホルダーから給電する方法を解説します。

## 📋 概要

XIAO MG24 Senseには、背面（裏面）にバッテリー接続用のパッドが用意されています。このガイドでは、CR2032ホルダー（LIR2032充電式電池対応）をこれらのパッドに接続する方法を説明します。

### バッテリーパッドの位置

```
[XIAO MG24 Sense 裏面図]

        USB Type-C
            ↓
    ┌───────────────────┐
    │                   │
    │  BAT-      BAT+   │  ← バッテリーパッド
    │   ●          ●    │     (間隔: 約12mm)
    │                   │
    │                   │
    │                   │
    └───────────────────┘
    
    BAT- : USB側（GND）
    BAT+ : USB反対側（+3.7V）
```

> [!IMPORTANT]
> **極性に注意！**
> - **BAT-**: USBポートに**近い側**（GND）
> - **BAT+**: USBポートから**遠い側**（+3.7V）
> - 逆接続すると基板が破損します！

---

## 接続方法の選択

バッテリーパッドへの接続方法は主に3つあります：

### 方法1: 直接はんだ付け（最もシンプル）
- **難易度**: ⭐⭐☆☆☆
- **着脱性**: なし（固定）
- **信頼性**: 高い
- **用途**: 恒久的な実装

### 方法2: ポゴピン接触（着脱可能）
- **難易度**: ⭐⭐⭐⭐☆
- **着脱性**: あり（繰り返し可能）
- **信頼性**: 中～高
- **用途**: テスト治具、充電ドック

### 方法3: フレキシブルケーブル
- **難易度**: ⭐⭐⭐☆☆
- **着脱性**: なし（固定）
- **信頼性**: 中
- **用途**: 省スペース実装

### 方法4: PCB貫通穴経由のケーブル接続
- **難易度**: ⭐⭐⭐☆☆
- **着脱性**: なし（固定）
- **信頼性**: 高
- **用途**: 柔軟なバッテリー配置、基板裏面への配線

---

## 方法1: 直接はんだ付け（推奨）

### 必要な部品・工具

#### 部品
- ✅ XIAO MG24 Sense本体
- ✅ CR2032ホルダー（CH25-2032LF）
- ✅ LIR2032充電式電池（3.6V, 40mAh）
- ✅ 細線ワイヤー（AWG28～30、長さ約5～10cm × 2本）
- ⚠️ 熱収縮チューブ（絶縁用、オプション）

#### 工具
- はんだごて（温度調整可能、推奨300～320℃）
- はんだ（鉛入りまたは鉛フリー、0.5mm径推奨）
- フラックス
- ピンセット
- ニッパー
- テスター（マルチメーター）
- 拡大鏡またはルーペ（推奨）

### 手順

#### ステップ1: CR2032ホルダーの準備

1. **CR2032ホルダーをPCBに実装**
   - ホルダーを基板に挿入
   - 裏面ではんだ付け
   - 極性マーク（+/-）を確認

2. **ワイヤーの準備**
   - 細線ワイヤーを2本用意（各5～10cm）
   - 両端の被覆を3～5mm剥く
   - 予備はんだを施す（ワイヤー先端にはんだを盛る）

#### ステップ2: ワイヤーをCR2032ホルダーに接続

1. **GND（-）側の接続**
   - CR2032ホルダーのパッド2（-側）にワイヤーをはんだ付け
   - ワイヤーに**黒色**のマーキングをする（識別用）

2. **+側の接続**
   - CR2032ホルダーのパッド1（+側）にワイヤーをはんだ付け
   - ワイヤーに**赤色**のマーキングをする（識別用）

#### ステップ3: XIAO MG24 Senseのバッテリーパッドにはんだ付け

> [!CAUTION]
> **はんだ付け時の注意**
> - はんだごての温度は**300～320℃**に設定（高温すぎると基板を破損）
> - はんだ付け時間は**2～3秒以内**に抑える
> - パッド間のショートに細心の注意を払う

1. **XIAO MG24 Senseの固定**
   - 基板を裏返し、バッテリーパッドが見える状態にする
   - 基板ホルダーや耐熱テープで固定

2. **BAT-パッドへの接続**
   - 黒色マーキングのワイヤーを準備
   - BAT-パッド（USB側）にフラックスを塗布
   - ワイヤーをパッドに当て、はんだごてで2～3秒加熱
   - はんだが流れて接続されたことを確認

3. **BAT+パッドへの接続**
   - 赤色マーキングのワイヤーを準備
   - BAT+パッド（USB反対側）にフラックスを塗布
   - ワイヤーをパッドに当て、はんだごてで2～3秒加熱
   - はんだが流れて接続されたことを確認

4. **絶縁処理**
   - 熱収縮チューブをワイヤーに被せる（オプション）
   - ヒートガンまたはライターで加熱して収縮させる

#### ステップ4: 動作確認

1. **目視検査**
   - はんだ付け箇所を拡大鏡で確認
   - BAT+とBAT-がショートしていないか確認
   - ワイヤーが断線していないか確認

2. **テスターでの確認**
   - **LIR2032を挿入する前に**テスターで導通確認
   - CR2032ホルダーの+端子 ⇔ XIAO BAT+パッド: 導通あり
   - CR2032ホルダーの-端子 ⇔ XIAO BAT-パッド: 導通あり
   - BAT+とBAT-間: 導通なし（ショートしていないこと）

3. **電圧確認**
   - LIR2032を挿入
   - テスターでBAT+とBAT-間の電圧を測定
   - **3.6V～4.2V**が表示されればOK

4. **動作テスト**
   - XIAOが起動するか確認
   - LEDプログラムをアップロードして点灯確認
   - シリアルモニタで動作確認

---

## 方法2: ポゴピン接触（着脱可能）

この方法では、専用のフットプリント `XIAO-MG24-Sense-Battery-PogoPin.kicad_mod` を使用します。

### 必要な部品・工具

#### 部品
- ✅ XIAO MG24 Sense本体
- ✅ CR2032ホルダー（CH25-2032LF）
- ✅ LIR2032充電式電池
- ✅ ポゴピン × 2個（推奨: P75-E2シリーズ、直径1.0～1.5mm）
- ✅ カスタムPCB（ポゴピンフットプリント使用）

### KiCadプロジェクトでの設計

#### ステップ1: フットプリントライブラリの追加

1. KiCadで「設定」→「フットプリントライブラリを管理」を開く
2. 「プロジェクト固有のライブラリ」タブを選択
3. `XIAO-MG24-Sense`ライブラリが追加されていることを確認
4. フットプリント `XIAO-MG24-Sense-Battery-PogoPin` が利用可能

#### ステップ2: 回路図の作成

1. **回路図エディタを開く**
2. **バッテリーコネクタシンボルを配置**
   - 2ピンのコネクタシンボルを使用
   - リファレンス: `J1` (Battery Contact)

3. **配線**
   ```
   CR2032ホルダー(BT1)のピン1(+) → J1のピン1(BAT+)
   CR2032ホルダー(BT1)のピン2(-) → J1のピン2(BAT-)
   ```

#### ステップ3: PCBレイアウト

1. **フットプリントの割り当て**
   - `J1`に `XIAO-MG24-Sense:XIAO-MG24-Sense-Battery-PogoPin` を割り当て

2. **PCBエディタでの配置**
   - XIAO MG24 Senseのメインフットプリントを配置
   - その**真下**にポゴピンフットプリントを配置
   - 位置合わせを正確に行う（バッテリーパッドと一致させる）

3. **配線**
   - CR2032ホルダーからポゴピンフットプリントまで配線
   - 電源ラインは太く（0.5mm以上）

#### ステップ4: 基板製造と組み立て

1. **ガーバーファイル生成とJLCPCB発注**
   - 前述の「JLCPCB発注ガイド.md」を参照

2. **ポゴピンの実装**
   - ポゴピンをSMDパッドにはんだ付け
   - ピンの高さを調整（3～5mm程度）
   - 垂直に立つように注意

3. **CR2032ホルダーの実装**
   - ホルダーをはんだ付け
   - LIR2032を挿入

4. **XIAO MG24 Senseの取り付け**
   - XIAOをポゴピンPCBの上に配置
   - バッテリーパッドがポゴピンに接触するように押し当てる
   - 固定クリップや3Dプリントケースで固定（推奨）

#### ステップ5: 動作確認

1. **接触確認**
   - XIAOを軽く押し付ける
   - テスターで導通確認

2. **電圧確認**
   - BAT+とBAT-間の電圧を測定（3.6V～4.2V）

3. **動作テスト**
   - XIAOが起動することを確認

---

## 方法3: フレキシブルケーブル（FFC/FPC）

### 概要

フレキシブルフラットケーブル（FFC）またはフレキシブルプリント基板（FPC）を使用して、CR2032ホルダーとXIAO MG24 Senseのバッテリーパッドを接続します。

### 必要な部品

- ✅ XIAO MG24 Sense本体
- ✅ CR2032ホルダー
- ✅ LIR2032充電式電池
- ✅ 2ピンFFCコネクタ × 2個（0.5mmピッチ推奨）
- ✅ FFCケーブル（2芯、長さ適宜）

### 手順

1. **カスタムPCBの設計**
   - CR2032ホルダー側にFFCコネクタを配置
   - XIAO取り付け側にFFCコネクタを配置

2. **FFCケーブルの接続**
   - FFCケーブルで2つのコネクタを接続
   - 極性に注意

3. **XIAOのバッテリーパッドに接続**
   - 方法1と同様に、ワイヤーをはんだ付け
   - ワイヤーをFFCコネクタに接続

---

## 方法4: PCB貫通穴経由のケーブル接続

### 概要

XIAO MG24 Senseをピンヘッダ/ピンソケットでPCBに実装する際、バッテリーパッドの真下にケーブル用の貫通穴を設けることで、XIAOの裏面からケーブルを通して基板裏面や任意の場所にバッテリーを配置できます。

```
[断面図]

XIAO MG24 Sense
┌─────────────────┐
│  [表面部品]      │
├─────────────────┤  ← 基板厚さ: 約1.0mm
│ ●BAT- BAT+●     │  ← バッテリーパッド（はんだ付け済）
└────┬──┬─────────┘
     │  │ ワイヤー（細線）
     │  │ ピンヘッダ
     ▼  ▼
┌────●──●─────────┐
│  ○穴 ○穴        │  ← PCB基板（貫通穴あり）
│    ↓  ↓         │
│  ワイヤーが穴を通過
├─────────────────┤
│ 基板裏面         │
│                 │
│ [CR2032]        │  ← 基板裏面にバッテリー配置
└─────────────────┘
```

### メリット

- ✅ XIAOを標準的なピンヘッダ/ピンソケットで実装可能
- ✅ バッテリーを基板裏面や任意の場所に配置できる
- ✅ ポゴピンのような特殊部品が不要
- ✅ 信頼性が高い（はんだ接続）
- ✅ 低コスト

### 必要な部品・工具

#### 部品
- ✅ XIAO MG24 Sense本体
- ✅ CR2032ホルダー（CH25-2032LF）
- ✅ LIR2032充電式電池
- ✅ 2.54mmピッチピンヘッダ（オス）× 14ピン × 2列
- ✅ 2.54mmピッチピンソケット（メス）× 14ピン × 2列
- ✅ 細線ワイヤー（AWG28～30、長さ適宜）× 2本
- ⚠️ 熱収縮チューブ（絶縁用、オプション）

#### 工具
- はんだごて（温度調整可能、推奨300～320℃）
- はんだ（鉛入りまたは鉛フリー、0.5mm径推奨）
- フラックス
- ピンセット
- ニッパー
- テスター（マルチメーター）
- 拡大鏡またはルーペ（推奨）

### KiCadでの設計手順

#### ステップ1: カスタムフットプリントの作成

1. **既存のXIAOフットプリントをコピー**
   - KiCadのフットプリントエディタを開く
   - 「ファイル」→「開く」から `XIAO-MG24-Sense.kicad_mod` を開く
   - 「ファイル」→「名前を付けて保存」で新しい名前で保存
   - 名前: `XIAO-MG24-Sense-CablePassThrough.kicad_mod`

2. **ケーブル貫通穴を追加（詳細手順）**
   
   バッテリーパッドの位置（XIAOの裏面）に対応する場所に、ケーブル用の貫通穴を配置します。
   
   **手順A: BAT-用の貫通穴を追加**
   
   1. フットプリントエディタの右側ツールバーから「パッドを追加」アイコンをクリック
      - または、メニュー「配置」→「パッド」
   
   2. フットプリント上の適切な位置（BAT-パッド下）をクリック
   
   3. パッドプロパティダイアログが開くので、以下のように設定：
      
      **基本設定タブ**:
      - **パッド番号**: 空欄（番号なし）
      - **パッドタイプ**: **NPTH, Mechanical**（メッキなし貫通穴）
      - **形状**: **円形**
      - **サイズ X**: **2.0** mm
      - **サイズ Y**: **2.0** mm
      - **ドリル径**: **2.0** mm
      
      **位置とオリエンテーション**:
      - **位置 X**: **-6.0** mm（XIAOの中心からの相対位置）
      - **位置 Y**: **0.0** mm
      - **回転**: **0°**
      
      **レイヤー**:
      - すべてのレイヤーのチェックを外す（NPTHの場合、銅層は不要）
      - または、自動的に設定される
   
   4. 「OK」をクリックして穴を配置
   
   **手順B: BAT+用の貫通穴を追加**
   
   1. 同様に「パッドを追加」をクリック
   
   2. BAT+パッド下の位置をクリック
   
   3. パッドプロパティダイアログで以下のように設定：
      
      **基本設定タブ**:
      - **パッド番号**: 空欄（番号なし）
      - **パッドタイプ**: **NPTH, Mechanical**
      - **形状**: **円形**
      - **サイズ X**: **2.0** mm
      - **サイズ Y**: **2.0** mm
      - **ドリル径**: **2.0** mm
      
      **位置とオリエンテーション**:
      - **位置 X**: **6.0** mm（XIAOの中心からの相対位置）
      - **位置 Y**: **0.0** mm
      - **回転**: **0°**
   
   4. 「OK」をクリックして穴を配置
   
   **手順C: 貫通穴の確認**
   
   1. フットプリントエディタの3Dビューアーで確認
      - メニュー「表示」→「3Dビューアー」
      - 貫通穴が正しい位置にあることを確認
   
   2. 穴の位置を微調整する場合
      - 穴を選択（クリック）
      - プロパティダイアログを開く（ダブルクリックまたは「E」キー）
      - 位置を調整
   
   **穴の仕様まとめ**:
   ```
   BAT-用貫通穴:
   - タイプ: NPTH（Non-Plated Through Hole、メッキなし貫通穴）
   - 形状: 円形
   - サイズ: 直径2.0mm
   - ドリル径: 2.0mm
   - 位置: X=-6.0mm, Y=0mm（XIAOの中心からの相対位置）
   
   BAT+用貫通穴:
   - タイプ: NPTH（Non-Plated Through Hole、メッキなし貫通穴）
   - 形状: 円形
   - サイズ: 直径2.0mm
   - ドリル径: 2.0mm
   - 位置: X=6.0mm, Y=0mm（XIAOの中心からの相対位置）
   ```

3. **シルクスクリーンを追加**
   
   1. 右側ツールバーから「テキストを追加」アイコンをクリック
      - または、メニュー「配置」→「テキスト」
   
   2. BAT-穴の近くをクリックしてテキストを配置
   
   3. テキストプロパティダイアログで設定：
      - **テキスト**: `BAT-`
      - **レイヤー**: `F.SilkS`（表面シルクスクリーン）
      - **サイズ**: 高さ 1.0mm、幅 1.0mm
      - **太さ**: 0.15mm
   
   4. 同様にBAT+穴の近くに `BAT+` のテキストを追加
   
   5. オプション: ケーブル通過方向の矢印を追加
      - 右側ツールバーから「線を追加」アイコンをクリック
      - レイヤー: `F.SilkS`
      - 穴から下方向への矢印を描画

4. **フットプリントの保存**
   
   1. メニュー「ファイル」→「保存」
   2. フットプリントライブラリに保存されます

#### ステップ2: 回路図の作成

1. **シンボルの配置**
   - XIAO MG24 Sense (U1)
   - CR2032ホルダー (BT1)

2. **配線**
   ```
   BT1 ピン1(+) → U1 BAT+（ワイヤー経由）
   BT1 ピン2(-) → U1 BAT-（ワイヤー経由）
   
   U1の他のピンはピンソケット経由で接続
   ```

#### ステップ3: PCBレイアウト

1. **フットプリントの配置**
   - カスタムフットプリント `XIAO-MG24-Sense-CablePassThrough` を配置
   - CR2032ホルダーを基板裏面に配置（または任意の場所）

2. **貫通穴の確認**
   - PCBエディタで貫通穴が正しい位置にあることを確認
   - 3Dビューで確認（XIAOのバッテリーパッド位置と一致）

3. **配線（基板裏面）**
   - CR2032ホルダーから貫通穴付近までトレースを配線
   - または、ワイヤーで直接接続する設計も可能

#### ステップ4: ガーバーファイル生成とJLCPCB発注

1. **ガーバーファイル生成**
   - 「JLCPCB発注ガイド.md」を参照
   - 貫通穴がEdge.Cutsレイヤーではなく、ドリルファイルに含まれることを確認

2. **JLCPCB発注**
   - 標準的な2層基板として発注
   - 貫通穴は自動的に加工されます

### 組み立て手順

#### ステップ1: XIAOへのワイヤーはんだ付け

1. **ワイヤーの準備**
   - 細線ワイヤーを2本用意（長さは基板サイズに応じて調整）
   - 片端の被覆を3～5mm剥く
   - 予備はんだを施す

2. **XIAOのバッテリーパッドにはんだ付け**
   - 方法1と同様に、XIAOの裏面バッテリーパッドにワイヤーをはんだ付け
   - BAT-（USB側）: 黒色ワイヤー
   - BAT+（USB反対側）: 赤色ワイヤー

3. **ワイヤーの長さ調整**
   - ワイヤーをPCBの貫通穴を通すのに十分な長さにする
   - 余裕を持たせる（5～10cm程度）

#### ステップ2: PCBへの実装

1. **ピンヘッダの取り付け**
   - XIAOにピンヘッダ（オス）をはんだ付け
   - または、先にPCBにピンソケット（メス）をはんだ付けしてから、XIAOをピンヘッダではんだ付け

2. **ワイヤーを貫通穴に通す**
   - XIAOをPCBのピンソケットに挿入する前に、ワイヤーを貫通穴に通す
   - ワイヤーが穴を通過したら、XIAOをピンソケットに挿入

3. **XIAOの固定**
   - ピンヘッダをピンソケットに挿入
   - 必要に応じてはんだ付け（着脱不要の場合）

#### ステップ3: バッテリーの接続

1. **CR2032ホルダーの実装**
   - 基板裏面（または任意の場所）にCR2032ホルダーをはんだ付け

2. **ワイヤーの接続**
   - 貫通穴から出たワイヤーをCR2032ホルダーにはんだ付け
   - 黒色ワイヤー（BAT-）→ CR2032ホルダーのパッド2（-）
   - 赤色ワイヤー（BAT+）→ CR2032ホルダーのパッド1（+）

3. **絶縁処理**
   - 熱収縮チューブでワイヤーを保護（オプション）
   - ワイヤーが他の部品や基板トレースに接触しないように配線

#### ステップ4: 動作確認

1. **目視検査**
   - ワイヤーが正しく貫通穴を通っているか確認
   - ワイヤーが他の部品に接触していないか確認

2. **テスターでの確認**
   - CR2032ホルダーの+端子 ⇔ XIAO BAT+パッド: 導通あり
   - CR2032ホルダーの-端子 ⇔ XIAO BAT-パッド: 導通あり
   - BAT+とBAT-間: 導通なし（ショートしていないこと）

3. **電圧確認**
   - LIR2032を挿入
   - テスターでBAT+とBAT-間の電圧を測定（3.6V～4.2V）

4. **動作テスト**
   - XIAOが起動するか確認
   - LEDプログラムをアップロードして点灯確認

### 設計のポイント

#### 貫通穴のサイズ

| ワイヤー本数 | 推奨穴径 | 備考 |
|------------|---------|------|
| 1本（AWG28） | 1.5mm | 単線の場合 |
| 2本（AWG28） | 2.0mm～2.5mm | BAT+とBAT-を1つの穴に通す場合 |
| 2本（AWG28） | 各1.5mm | BAT+とBAT-を別々の穴に通す場合（推奨） |

> [!TIP]
> **推奨設計**
> - BAT+とBAT-用に**別々の穴**を設けることを推奨
> - 穴径は**2.0mm**が適切（AWG28ワイヤーに対して余裕あり）
> - 穴の位置はXIAOのバッテリーパッドの真下に配置

#### 貫通穴の配置例

```
[トップビュー - PCB基板]

    ┌───────────────────────┐
    │                       │
    │  ┌─────────────────┐  │
    │  │ XIAO MG24 Sense │  │
    │  │ (ピンソケット)   │  │
    │  │                 │  │
    │  │  ○穴   ○穴      │  │  ← 貫通穴（BAT-、BAT+）
    │  └─────────────────┘  │
    │                       │
    └───────────────────────┘

[ボトムビュー - PCB基板裏面]

    ┌───────────────────────┐
    │                       │
    │  ○穴   ○穴            │  ← ワイヤーが出てくる
    │   ↓     ↓             │
    │  [CR2032ホルダー]     │
    │                       │
    └───────────────────────┘
```

### 応用例

#### 1. バッテリーを基板端に配置

```
XIAOを基板中央に配置し、バッテリーを基板端に配置することで、
XIAOの真下のスペースを他の部品に使用できます。
```

#### 2. 複数のXIAOに1つのバッテリー

```
複数のXIAOを1つの基板に実装し、1つのバッテリーから
並列に電源供給することも可能です（電流容量に注意）。
```

#### 3. 外部バッテリーボックスへの配線

```
貫通穴から出たワイヤーをコネクタに接続し、
外部バッテリーボックスに接続することも可能です。
```

---

## 電源仕様と注意事項

### LIR2032の仕様

| 項目 | 仕様 |
|------|------|
| **公称電圧** | 3.6V |
| **満充電電圧** | 4.2V |
| **放電終止電圧** | 2.75V |
| **容量** | 40mAh（標準） |
| **充電電流** | 最大50mA（XIAO内蔵充電回路） |
| **サイズ** | 直径20mm × 厚さ3.2mm |

### XIAO MG24 Senseの電源仕様

| 項目 | 仕様 |
|------|------|
| **動作電圧範囲** | 2.0V～3.6V |
| **推奨電源** | 3.7V Li-Po/Li-ion |
| **消費電流（動作時）** | 約5～20mA |
| **消費電流（スリープ時）** | 約5～50μA |
| **消費電流（ディープスリープ時）** | 約2～5μA |

### 重要な注意事項

> [!WARNING]
> **電圧に関する注意**
> - LIR2032の満充電電圧（4.2V）は、XIAO MG24 Senseの最大動作電圧（3.6V）を**超えています**
> - XIAO MG24 Senseには内蔵の電源管理チップがあり、バッテリー電圧を適切に処理します
> - ただし、**CR2032（一次電池、3V）は使用しないでください**。LIR2032（充電式、3.6V）を使用してください

> [!CAUTION]
> **極性の確認**
> - はんだ付け前に必ず極性を確認してください
> - BAT+とBAT-を逆接続すると、XIAO MG24 Senseが破損します
> - テスターで導通確認を行ってから電池を挿入してください

> [!IMPORTANT]
> **充電機能について**
> - XIAO MG24 SenseにはLi-Po/Li-ion充電回路が内蔵されています
> - USB Type-Cケーブルを接続すると、LIR2032が自動的に充電されます
> - 充電電流: 最大50mA
> - 充電状態は赤色LEDで表示されます:
>   - **点滅**: 充電中
>   - **消灯**: 充電完了またはバッテリー未接続

---

## バッテリー駆動時間の計算

### 計算式

```
駆動時間(時間) = バッテリー容量(mAh) / 平均消費電流(mA)
```

### 使用例

#### ケース1: 常時動作（BLE通信あり）
- **平均消費電流**: 約15mA
- **駆動時間**: 40mAh / 15mA = **約2.7時間**

#### ケース2: 間欠動作（1秒動作、9秒スリープ）
- **動作時消費電流**: 15mA × 0.1秒 = 1.5mA
- **スリープ時消費電流**: 0.05mA × 0.9秒 = 0.045mA
- **平均消費電流**: 1.5mA + 0.045mA = 1.545mA
- **駆動時間**: 40mAh / 1.545mA = **約26時間**

#### ケース3: ディープスリープ主体（1分に1回起動）
- **動作時消費電流**: 15mA × 5秒 / 60秒 = 1.25mA
- **スリープ時消費電流**: 0.005mA × 55秒 / 60秒 = 0.0046mA
- **平均消費電流**: 1.25mA + 0.0046mA = 1.2546mA
- **駆動時間**: 40mAh / 1.2546mA = **約32時間**

> [!TIP]
> **バッテリー駆動時間を延ばすには**
> - ディープスリープモードを活用する
> - BLE通信の頻度を減らす
> - 不要なペリフェラル（IMU、マイクなど）を無効化する
> - より大容量のLi-Poバッテリーを使用する（例: 100mAh、500mAhなど）

---

## トラブルシューティング

### 問題1: XIAOが起動しない

**考えられる原因と対策**:

1. **極性が逆**
   - テスターでBAT+とBAT-の電圧を確認
   - 正しい極性で再接続

2. **はんだ付け不良**
   - 拡大鏡で接続箇所を確認
   - 冷はんだ（灰色で光沢がない）の場合は再はんだ

3. **電池電圧が低い**
   - LIR2032の電圧を測定（2.75V以下なら充電が必要）
   - USB経由で充電してから再テスト

4. **ショート**
   - テスターでBAT+とBAT-間の抵抗を測定
   - 0Ω（ショート）の場合は配線を確認

### 問題2: 充電されない

**考えられる原因と対策**:

1. **赤色LEDが点灯しない**
   - USB Type-Cケーブルが正しく接続されているか確認
   - 電源供給可能なUSBポートか確認（データ専用ポートでは充電不可）

2. **赤色LEDがすぐ消える**
   - バッテリーが満充電の可能性
   - 電圧を測定（4.2V付近なら満充電）

3. **バッテリー接続不良**
   - はんだ付け箇所の導通確認
   - ワイヤーの断線確認

### 問題3: バッテリー駆動時間が短い

**考えられる原因と対策**:

1. **消費電流が大きい**
   - スリープモードを実装する
   - 不要な機能を無効化する

2. **バッテリー容量が低下**
   - LIR2032の寿命（約500サイクル）
   - 新しいバッテリーに交換

3. **バッテリー容量が小さい**
   - より大容量のLi-Poバッテリーに変更（例: 100mAh、500mAh）

### 問題4: ポゴピン接触が不安定

**考えられる原因と対策**:

1. **接触圧力が不足**
   - ポゴピンのストロークを確認
   - より強いスプリングのポゴピンに交換

2. **位置ずれ**
   - XIAOの位置決めガイドを追加
   - 3Dプリントケースで固定

3. **ポゴピンの酸化**
   - 接点復活剤を使用
   - 金メッキポゴピンに交換

---

## 推奨部品リスト

### 基本部品

| 部品名 | 型番/仕様 | 購入先 | 価格目安 |
|--------|----------|--------|---------|
| XIAO MG24 Sense | 102110644 | [Switch Science](https://www.switch-science.com/products/10224) | ¥2,090 |
| CR2032ホルダー | CH25-2032LF (100706) | [秋月電子](https://akizukidenshi.com/catalog/g/g100706/) | ¥100 |
| LIR2032電池 | 3.6V 40mAh | [秋月電子](https://akizukidenshi.com/catalog/g/g114730/) | ¥300 |

### ポゴピン接触用（方法2）

| 部品名 | 型番/仕様 | 購入先 | 価格目安 |
|--------|----------|--------|---------|
| ポゴピン | P75-E2 (直径1.0mm) | [AliExpress](https://www.aliexpress.com/) | ¥50/個 |
| ポゴピン | P100-E (直径1.5mm) | [AliExpress](https://www.aliexpress.com/) | ¥80/個 |

### 配線用（方法1）

| 部品名 | 仕様 | 購入先 | 価格目安 |
|--------|------|--------|---------|
| 細線ワイヤー | AWG28～30 | [秋月電子](https://akizukidenshi.com/) | ¥200/m |
| 熱収縮チューブ | 直径2mm | [秋月電子](https://akizukidenshi.com/) | ¥100 |

---

## 参考リンク

### 公式ドキュメント
- [XIAO MG24 Sense 公式Wiki（日本語）](https://wiki.seeedstudio.com/ja/xiao_mg24_getting_started/)
- [XIAO MG24 Sense 製品ページ](https://www.switch-science.com/products/10224)
- [CR2032ホルダー データシート](https://akizukidenshi.com/goodsaffix/CH25-2032LF.pdf)

### KiCadライブラリ
- [XIAO-MG24-Sense README](./XIAO-MG24-Sense/README.md)
- [XIAO-MG24-Sense Battery PogoPin README](./XIAO-MG24-Sense/README_Battery_PogoPin.md)
- [CR2032-Holder README](./CR2032-holder/README.md)

### 関連ガイド
- [JLCPCB発注ガイド](./JLCPCB発注ガイド.md)

---

## まとめ

このガイドでは、XIAO MG24 SenseのバッテリーパッドにCR2032ホルダー（LIR2032）を接続する3つの方法を紹介しました。

### 方法の選択基準

| 方法 | 難易度 | 着脱性 | 信頼性 | 推奨用途 |
|------|--------|--------|--------|---------|
| **直接はんだ付け** | ⭐⭐☆☆☆ | なし | 高 | 恒久的な実装、製品化 |
| **ポゴピン接触** | ⭐⭐⭐⭐☆ | あり | 中～高 | テスト治具、充電ドック |
| **フレキシブルケーブル** | ⭐⭐⭐☆☆ | なし | 中 | 省スペース実装 |
| **PCB貫通穴経由** | ⭐⭐⭐☆☆ | なし | 高 | 柔軟なバッテリー配置、基板裏面実装 |

### 初心者へのおすすめ

**方法1（直接はんだ付け）**が最もシンプルで信頼性が高いため、初めての方にはこちらをおすすめします。

### 注意点の再確認

1. ✅ **極性を必ず確認**（BAT-はUSB側、BAT+はUSB反対側）
2. ✅ **LIR2032を使用**（CR2032一次電池は不可）
3. ✅ **はんだ付け前にテスターで導通確認**
4. ✅ **ショートに注意**（BAT+とBAT-を絶対にショートさせない）

頑張ってください！ 🔋⚡
